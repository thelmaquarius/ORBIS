<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Orbis</title>

    <style>
        @font-face {
          font-family: "Français";
          src:
            url("Francais.otf") format("opentype")
        }
    

      /* --- Structure générale --- */
      html, body {
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        /* overflow-y: hidden; */
        font-family: system-ui, sans-serif;
        color: #fff;
        /* background-color: #000; */
      }

      /* --- Section intro vidéo --- */
      body{
        background-color: #6b5e49;
      }
      #intro {
        height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      video.background {
        opacity: 70%;
        position: fixed;
        top: 50%;
        left: 50%;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: translate(-50%, -50%);
        z-index: -1;
        
      }

      .titre {
        font-size: 4rem;
        /* background: rgba(0, 0, 0, 0.4); */
        padding: 1rem 2rem;
        border-radius: 1rem;
        z-index: 1;
        font-family: "Français";
      }

      /* --- Contenu principal --- */
      #main-content {
        opacity: 0;
        transform: translateY(50px);
        transition: opacity 1.2s ease-out, transform 1.2s ease-out;
        background-color: #fafafa;
        color: #222;
      }

      #main-content.visible {
        opacity: 1;
        transform: translateY(0);
      }

      header {
        background: #222;
        color: white;
        padding: 1rem;
      }

      header ul {
        list-style: none;
        display: flex;
        gap: 2rem;
        margin: 0;
        padding: 0;
        justify-content: center;
      }

      header li {
        cursor: pointer;
        transition: color 0.3s;
      }

      header li:hover {
        color: #00aaff;
      }

      section {
        max-width: 900px;
        margin: 3rem auto;
        padding: 1rem;
        line-height: 1.6;
      }

      .separateur {
        height: 2px;
        width: 100%;
        background: #ddd;
        margin: 2rem 0;
      }

      canvas.canvaTerre {
        display: block;
        width: 100%;
        height: 200px;
        background: #eee;
      }
    </style>
  </head>

  <body>
    <!-- Intro vidéo -->
    <section id="intro">
      <video class="background" autoplay muted playsinline preload="auto">
        <source src="Vidéo planète.mp4" type="video/mp4" />
        Votre navigateur ne supporte pas la vidéo HTML5.
      </video>
      <h1 class="titre" id="titre">Orbis</h1>
    </section>

    <!-- Contenu principal -->
    <main id="main-content">
      <header>
        <ul>
          <li>Le Projet</li>
          <li>Nos Sources</li>
          <li>Qui sommes-nous ?</li>
          <li>Menu 4</li>
        </ul>
      </header>

      <section>
        <canvas class="canvaTerre"></canvas>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Ut officia
          accusantium deleniti quam cumque facilis qui nisi reprehenderit sunt
          dignissimos quasi, veritatis explicabo placeat tempora hic distinctio
          quas magni mollitia pariatur odio autem, excepturi repellendus eaque
          omnis! Dolores iure ut molestias harum similique delectus explicabo
          culpa quidem. Commodi, accusamus repellendus.
        </p>
        <div class="separateur"></div>
      </section>

      <section>
        <canvas class="canvaTerre"></canvas>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Ut officia
          accusantium deleniti quam cumque facilis qui nisi reprehenderit sunt
          dignissimos quasi, veritatis explicabo placeat tempora hic distinctio
          quas magni mollitia pariatur odio autem, excepturi repellendus eaque
          omnis! Dolores iure ut molestias harum similique delectus explicabo
          culpa quidem. Commodi, accusamus repellendus.
        </p>
        <div class="separateur"></div>
      </section>
    </main>

    <script>
      const video = document.querySelector("video.background");
      const main = document.getElementById("main-content");

      function videoScroll() {
        
      }
      // Attendre que la vidéo soit prête à jouer
      video.addEventListener("canplaythrough", () => {
        console.log("Vidéo chargée, lancement du compte à rebours...");

        // Lancer le défilement après 7 secondes (à ajuster)
        setTimeout(() => {
          window.scrollTo({ top: window.innerHeight, behavior: "smooth" });
          main.classList.add("visible");
        }, 14720);
      });

      // Sécurité : si la vidéo ne charge jamais, déclencher après 10s
      setTimeout(() => {
        if (!main.classList.contains("visible")) {
          console.warn("Timeout forcé — la vidéo a peut-être mis trop de temps à charger.");
          window.scrollTo({ top: window.innerHeight, behavior: "smooth" });
          main.classList.add("visible");
        }
      }, 14720);

      // --- Exemple de chargement des alphabets depuis ton fichier JSON ---
let alphabets = []; // Ton JSON (copié ou importé via fetch)
let targetText = document.querySelector('.titre').innerHTML;

// --- Fonction principale ---
async function decodeText(targetText, totalDuration, elementId) {
  // --- Chargement des alphabets ---
  const res = await fetch('alphabets_rotated.json');
  const alphabets = await res.json();

  if (!alphabets.length) {
    console.error("⚠️ Les alphabets ne sont pas encore chargés !");
    return;
  }

  const el = document.getElementById(elementId);
  const letters = targetText.split('');
  const steps = letters.length;
  const stepDuration = totalDuration / steps;

  const random = arr => arr[Math.floor(Math.random() * arr.length)];
  let locked = 0;

  const interval = setInterval(() => {
    // À chaque frame, on choisit un alphabet aléatoire
    const currentAlphabet = random(alphabets);
    const chars = Object.values(currentAlphabet).filter(c => c && c.trim() !== '');

    let displayed = '';

    for (let i = 0; i < letters.length; i++) {
      if (i < locked) {
        displayed += letters[i]; // lettres déjà fixées
      } else {
        displayed += random(chars); // caractères aléatoires dans cette langue
      }
    }

    el.textContent = displayed;
  }, 150); // fréquence de mutation (50ms)

  // verrouillage progressif des lettres
  for (let i = 0; i <= letters.length; i++) {
    await new Promise(res => setTimeout(res, stepDuration));
    locked = i;
  }

  clearInterval(interval);
  el.textContent = targetText;
}

// --- Démarrage ---
window.addEventListener('DOMContentLoaded', () => {
  const targetText = document.querySelector('.titre').innerHTML;
  decodeText(targetText, 11000, 'titre');
});


    </script>
  </body>
</html>
